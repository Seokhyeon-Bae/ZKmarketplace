═══════════════════════════════════════════════════════════════════════
                    DISPUTE RESOLUTION FLOW DIAGRAM
═══════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│                         NORMAL ORDER FLOW                            │
│                         (No Problems)                                │
└─────────────────────────────────────────────────────────────────────┘

    Seller                                           Buyer
      │                                                │
      │  1. Create Order + Deposit 1 ETH               │
      │───────────────────────────────────────────────>│
      │                                                │
      │                                                │
      │  2. Buyer Funds Order (1 ETH)                  │
      │<───────────────────────────────────────────────│
      │                                                │
      │         [Escrow holds 2 ETH total]             │
      │                                                │
      │  3. Ship Product                               │
      │━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━>│
      │                                                │
      │  4. Buyer Confirms Receipt                     │
      │<───────────────────────────────────────────────│
      │                                                │
      │  5. Seller Gets Paid (1 ETH - 2.5% fee)        │
      │<═══════════════════════════════════════════════│
      │                                                │
      └─────────────────   ✅ SUCCESS   ──────────────┘


═══════════════════════════════════════════════════════════════════════


┌─────────────────────────────────────────────────────────────────────┐
│                        DISPUTE FLOW                                  │
│                    (Something Goes Wrong)                            │
└─────────────────────────────────────────────────────────────────────┘

    Seller                  System                    Buyer
      │                       │                         │
      │  1. Order Funded      │                         │
      │<══════════════════════╬═════════════════════════│
      │                       │                         │
      │   [2 ETH in Escrow]   │                         │
      │                       │                         │
      │  2. Ship Product      │                         │
      │━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━>│
      │                       │                         │
      │                       │   3. Problem! 🚨        │
      │                       │   (Never received)      │
      │                       │<────────────────────────│
      │                       │                         │
      │                       │  4. Raise Dispute       │
      │                       │    - Pay 0.01 ETH       │
      │                       │    - Submit Evidence    │
      │                       │<════════════════════════│
      │                       │                         │
      │   5. Get Notification │                         │
      │<──────────────────────│                         │
      │                       │                         │
      │  6. Submit Evidence   │                         │
      │   (Shipping proof)    │                         │
      │──────────────────────>│                         │
      │                       │                         │
      │                       │  7. Submit More Evidence│
      │                       │    (Tracking, photos)   │
      │                       │<────────────────────────│
      │                       │                         │
      │                       ▼                         │
      │              ┌─────────────────┐                │
      │              │   ARBITRATOR    │                │
      │              │   Reviews Case  │                │
      │              │                 │                │
      │              │  • Checks all   │                │
      │              │    evidence     │                │
      │              │  • Verifies     │                │
      │              │    timestamps   │                │
      │              │  • Makes fair   │                │
      │              │    decision     │                │
      │              └────────┬────────┘                │
      │                       │                         │
      │                       │  8. DECISION            │
      │                       ▼                         │
      │              ┌─────────────────┐                │
      │              │  Buyer Wins OR  │                │
      │              │  Seller Wins    │                │
      │              └────────┬────────┘                │
      │                       │                         │
      │                       ├─────────────────────────┐
      │                       │                         │
      ▼                       ▼                         ▼


═══════════════════════════════════════════════════════════════════════
                         OUTCOME SCENARIOS
═══════════════════════════════════════════════════════════════════════


┌─────────────────────────────────────────────────────────────────────┐
│ SCENARIO A: BUYER WINS                                               │
│ (Example: Package never delivered)                                   │
└─────────────────────────────────────────────────────────────────────┘

    Arbitrator Decision:
    "Tracking shows package returned to sender.
     Buyer provided proof of empty mailbox.
     Winner: Buyer"

    💰 Money Distribution:
    
    Buyer Receives:
    ├─ 1 ETH (his payment returned)
    └─ 0.01 ETH (dispute fee returned)
    
    Seller Receives:
    └─ 0 ETH (lost dispute)
    
    📊 Reputation:
    ├─ Buyer: +15 points (won dispute)
    └─ Seller: -10 points (lost dispute)


┌─────────────────────────────────────────────────────────────────────┐
│ SCENARIO B: SELLER WINS                                              │
│ (Example: Buyer received item but claims they didn't)                │
└─────────────────────────────────────────────────────────────────────┘

    Arbitrator Decision:
    "Delivery confirmed with signature.
     Security camera shows buyer receiving package.
     Winner: Seller"

    💰 Money Distribution:
    
    Seller Receives:
    └─ 1 ETH (payment for product)
    
    Buyer Receives:
    ├─ 0 ETH (lost dispute)
    └─ 0.01 ETH (dispute fee returned)
    
    📊 Reputation:
    ├─ Seller: +15 points (won dispute)
    └─ Buyer: -10 points (lost dispute, attempted fraud)


═══════════════════════════════════════════════════════════════════════
                            KEY ROLES
═══════════════════════════════════════════════════════════════════════

    👤 BUYER
    ├─ Can raise disputes
    ├─ Can submit evidence
    └─ Receives refund if wins

    👤 SELLER
    ├─ Can raise disputes
    ├─ Can submit evidence
    └─ Gets paid if wins

    ⚖️  ARBITRATOR
    ├─ Authorized by contract owner
    ├─ Reviews all evidence
    ├─ Makes final binding decision
    └─ Cannot be buyer or seller

    🔐 CONTRACT OWNER
    ├─ Adds/removes arbitrators
    ├─ Sets dispute fee
    └─ Manages system settings


═══════════════════════════════════════════════════════════════════════
                         EVIDENCE EXAMPLES
═══════════════════════════════════════════════════════════════════════

    📦 SELLER EVIDENCE:
    ├─ Shipping receipt
    ├─ Tracking number
    ├─ Photos of package before shipping
    ├─ Weight/dimension receipts
    └─ Communication logs

    📭 BUYER EVIDENCE:
    ├─ Empty mailbox photos/video
    ├─ Tracking showing "not delivered"
    ├─ Communication with seller
    ├─ Damaged product photos
    └─ Neighbor/security camera footage


═══════════════════════════════════════════════════════════════════════
                         TIME-BASED VIEW
═══════════════════════════════════════════════════════════════════════

    Day 0
    ├─ Order Created & Funded
    └─ Seller ships product
    
    Day 3
    └─ Expected delivery date
    
    Day 5
    ├─ Buyer doesn't receive package
    └─ 🚨 Raises Dispute
    
    Day 5-6
    ├─ Both parties submit evidence
    └─ Status: Open → Under Review
    
    Day 7-8
    └─ Arbitrator reviews case
    
    Day 9
    ├─ Decision made
    ├─ Funds distributed
    └─ ✅ Status: Resolved


═══════════════════════════════════════════════════════════════════════
                      SECURITY FEATURES
═══════════════════════════════════════════════════════════════════════

    🔒 PREVENTS:
    ├─ Spam disputes (via 0.01 ETH fee)
    ├─ Unauthorized resolution (only arbitrators)
    ├─ Evidence tampering (IPFS immutable)
    ├─ Double disputes (one per order)
    └─ Fund theft (escrow locked until resolution)

    ✅ ENSURES:
    ├─ Fair process (both can submit evidence)
    ├─ Transparency (all on blockchain)
    ├─ Accountability (arbitrator tracked)
    ├─ Finality (decision is binding)
    └─ Safety (funds held in smart contract)


═══════════════════════════════════════════════════════════════════════
                         STATE MACHINE
═══════════════════════════════════════════════════════════════════════

                    ┌──────────────┐
                    │              │
                    │  No Dispute  │
                    │              │
                    └──────┬───────┘
                           │
                           │ raiseDispute()
                           ▼
                    ┌──────────────┐
                    │              │
              ┌────>│     OPEN     │<────┐
              │     │              │     │
              │     └──────┬───────┘     │
              │            │             │
              │            │ updateStatus() submitEvidence()
              │            ▼             │
              │     ┌──────────────┐     │
              │     │              │     │
              └─────│ UNDER REVIEW │─────┘
                    │              │
                    └──────┬───────┘
                           │
                           │ resolveDispute()
                           ▼
                    ┌──────────────┐
                    │              │
                    │   RESOLVED   │  ← FINAL STATE
                    │              │
                    └──────────────┘


═══════════════════════════════════════════════════════════════════════
                    COST BREAKDOWN (Example)
═══════════════════════════════════════════════════════════════════════

    Order Value: 1 ETH ($2,000)
    
    Initial Deposits:
    ├─ Seller deposits: 1 ETH
    └─ Buyer deposits: 1 ETH
    
    Dispute Costs:
    └─ Dispute fee: 0.01 ETH (~$20) ← Refunded after resolution
    
    If Buyer Wins:
    Buyer gets back: 1.01 ETH ($2,020)
    Seller gets: 0 ETH
    Net cost to buyer: $0
    
    If Seller Wins:
    Seller gets: 1 ETH ($2,000)
    Buyer gets: 0.01 ETH ($20)
    Net gain to seller: $2,000 - gas fees


═══════════════════════════════════════════════════════════════════════

                         🎯 SUMMARY

    The Dispute Resolution Framework provides a fair, transparent,
    and secure way to handle conflicts in peer-to-peer transactions.

    Key Benefits:
    ✅ Fair arbitration process
    ✅ Evidence-based decisions
    ✅ Financial incentives aligned properly
    ✅ Permanent record on blockchain
    ✅ Reputation system integration
    ✅ Protection for both parties

═══════════════════════════════════════════════════════════════════════


